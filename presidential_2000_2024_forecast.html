<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>Election Forecast</title>
<!-- D3 + TopoJSON -->
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
<!-- Inter Font -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<style>
    html{ color-scheme: light; }

    :root{
      /* Palette */
      --bg-app: #f3f4f6;
      --bg-gradient-1: #eef2ff;
      --bg-gradient-2: #fff1f2;
      
      --ink: #111827;
      --ink-dim: #374151;
      --muted: #6b7280;
      --muted-light: #9ca3af;

      --card-bg: rgba(255, 255, 255, 0.85);
      --card-border: rgba(255, 255, 255, 0.6);
      --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
      --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.04);

      --line: #e5e7eb;
      --line-strong: #d1d5db;

      /* Political Colors (Modern Standard) */
      --blue: #2563eb;
      --blue-dark: #1e40af;
      --blue-soft: #dbeafe;
      --blue-border: #93c5fd;

      --red: #dc2626;
      --red-dark: #991b1b;
      --red-soft: #fee2e2;
      --red-border: #fca5a5;

      --neutral-bg: #f9fafb;
      --neutral-border: #e5e7eb;

      /* UI */
      --focus-ring: 0 0 0 3px rgba(99, 102, 241, 0.3);
      --radius-lg: 16px;
      --radius-md: 12px;
      --radius-sm: 8px;
      --radius-pill: 9999px;

      --sans: 'Inter', system-ui, -apple-system, sans-serif;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;

      /* Semantic */
      --ok: #10b981;
      --warn: #f59e0b;
      --zero: #1f2937;
    }

    *{ box-sizing:border-box }
    html,body{ height:100% }
    
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background-color: var(--bg-app);
      background-image:
        radial-gradient(circle at 10% 10%, var(--bg-gradient-1), transparent 40%),
        radial-gradient(circle at 90% 20%, var(--bg-gradient-2), transparent 40%);
      background-attachment: fixed;
      overflow-x:hidden;
      -webkit-font-smoothing: antialiased;
    }

    .wrap{
      max-width:1280px;
      margin:0 auto;
      padding:24px;
    }

    /* App Bar */
    .appbar{
      position:sticky;
      top:0;
      z-index:60;
      padding:16px 0 20px;
      /* Gradient fade for scroll area */
      background: linear-gradient(to bottom, var(--bg-app) 0%, rgba(243,244,246,0.8) 60%, transparent 100%);
      pointer-events: none; /* Let clicks pass through the padding areas */
    }
    .appbarInner{
      pointer-events: auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      padding:12px 16px;
      border-radius:var(--radius-lg);
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border:1px solid var(--card-border);
      box-shadow: var(--card-shadow);
      flex-wrap:wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:250px;
    }
    .brandMark{
      width:40px;height:40px;
      border-radius:12px;
      background: linear-gradient(135deg, var(--blue), var(--blue-dark));
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
      position: relative;
      overflow: hidden;
    }
    /* Simple stylized flag element inside brandMark */
    .brandMark::after {
      content: "";
      position: absolute;
      top: 0; right: 0; bottom: 0; left: 50%;
      background: rgba(255,255,255,0.15);
      transform: skewX(-15deg) translateX(5px);
    }
    
    .brandTitle{
      display:flex;
      flex-direction:column;
      line-height:1.1;
    }
    .brandTitle .t{
      font-size:16px;
      font-weight:800;
      letter-spacing:-0.01em;
      color: var(--ink);
    }
    .brandTitle .s{
      font-size:13px;
      color:var(--muted);
      font-weight:500;
    }

    /* Segmented Control */
    .seg{
      position:relative;
      display:flex;
      background: var(--neutral-bg);
      border:1px solid var(--line);
      border-radius:var(--radius-pill);
      padding:4px;
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.03);
      min-width:280px;
      justify-content:space-between;
    }
    .seg button{
      position:relative;
      appearance:none;
      border:none;
      background:transparent;
      color:var(--muted);
      font-weight:600;
      font-size:13px;
      padding:8px 16px;
      border-radius:var(--radius-pill);
      cursor:pointer;
      flex:1;
      text-align:center;
      transition: color .2s ease;
      z-index: 2;
    }
    .seg button:hover { color: var(--ink-dim); }
    .seg button.active{ color: var(--blue-dark); text-shadow: 0 0 1px rgba(0,0,0,0.1); }
    .segIndicator{
      position:absolute;
      top:4px; bottom:4px;
      width:calc(33.333% - 4px);
      border-radius:var(--radius-pill);
      background: #ffffff;
      border:1px solid rgba(0,0,0,0.04);
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
      transform: translateX(0%);
      transition: transform .25s cubic-bezier(0.2, 0.8, 0.2, 1);
      z-index: 1;
      pointer-events:none;
    }
    .seg[data-mode="governor"] .segIndicator{ transform: translateX(100%); }
    .seg[data-mode="house"] .segIndicator{ transform: translateX(200%); }

    /* Layout */
    .layout{
      display:grid;
      /* Force single column stack for safety, logic matches original code which had display:block but grid gap support */
      grid-template-columns: 1fr; 
      gap:24px;
      margin-top:0px;
    }
    @media (min-width: 980px){
        /* Original was column, let's keep it stacked but add spacing */
    }

    /* Cards */
    .card{
      border:1px solid var(--card-border);
      border-radius:var(--radius-lg);
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      box-shadow: var(--card-shadow);
      overflow:hidden;
      transition: box-shadow 0.2s ease;
    }
    .card:hover {
      box-shadow: var(--card-shadow-hover);
    }
    
    .cardTitleRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      padding:16px 20px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(to bottom, rgba(255,255,255,0.5), rgba(255,255,255,0));
    }

    .cardTitle{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .cardTitle .h{
      font-size:15px;
      font-weight:700;
      color: var(--ink);
    }
    .cardTitle .sub{
      font-size:13px;
      color:var(--muted);
      font-weight:500;
    }
    .cardInner{ padding:20px; }

    /* Projected Seats Card */
    .seatHeader{
      display:flex;
      flex-wrap:wrap;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      padding:20px 20px 16px;
      border-bottom:1px solid var(--line);
    }
    .seatHeadLeft .h{ margin:0; font-size:14px; font-weight:700; color:var(--muted); text-transform: uppercase; letter-spacing: 0.03em;}
    .seatNumbers{
      margin-top:6px;
      font-size:26px;
      font-weight:800;
      letter-spacing:-0.03em;
      color:var(--ink);
      font-variant-numeric: tabular-nums;
    }

    .seatPill{
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 16px;
      border-radius:var(--radius-md);
      border:1px solid var(--line);
      background: #ffffff;
      box-shadow: var(--card-shadow);
      user-select:none;
      min-width: 160px;
    }
    .seatDot{
      width:10px; height:10px;
      border-radius:50%;
      background: var(--muted-light);
      flex:0 0 auto;
    }
    .seatPill.blue{ border-color: var(--blue-border); background: var(--blue-soft); }
    .seatPill.blue .seatDot{ background: var(--blue); box-shadow: 0 0 0 2px #fff; }
    
    .seatPill.red{ border-color: var(--red-border); background: var(--red-soft); }
    .seatPill.red  .seatDot{ background: var(--red); box-shadow: 0 0 0 2px #fff; }
    
    .seatPill.neutral .seatDot{ background: var(--muted); }

    .seatPillLabel{
      font-size:11px;
      font-weight:700;
      letter-spacing:.05em;
      text-transform:uppercase;
      color:var(--ink-dim);
      opacity: 0.7;
    }
    .seatPillValue{
      font-size:14px;
      font-weight:700;
      color:var(--ink);
      font-variant-numeric: tabular-nums;
      line-height:1.2;
    }
    .seatPillTextWrap{ display:flex; flex-direction:column; }

    .seatLegendRow{
      margin-top:16px;
      display:flex;
      gap:16px;
      flex-wrap:wrap;
      align-items:center;
      color:var(--muted);
      font-size:13px;
      font-weight:500;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius:6px;
      font-size:12px;
      font-weight:600;
      font-family: var(--mono);
    }
    .chip.blue{ background: var(--blue-soft); color: var(--blue-dark); }
    .chip.red{ background: var(--red-soft); color: var(--red-dark); }

    /* Seat meter */
    .seatAxis{
      position:relative;
      height:72px;
      border-radius:var(--radius-md);
      border:1px solid var(--line);
      background: var(--neutral-bg);
      overflow:hidden;
    }
    #seatTicks{ position:absolute; inset:0; pointer-events:none;}
    .seatBar{
      position:absolute;
      left:16px; right:16px;
      top:26px;
      height:16px;
      border-radius:8px;
      background: rgba(0,0,0,0.05);
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
      overflow:hidden;
      display:flex;
    }
    .seatSeg{ height:100%; transition: width .4s cubic-bezier(0.2, 0.8, 0.2, 1); }
    
    .seatD{ background: linear-gradient(180deg, var(--blue) 0%, var(--blue-dark) 100%); }
    .seatR{ background: linear-gradient(180deg, var(--red) 0%, var(--red-dark) 100%); }
    .seatO{ background: transparent; }

    .seatMajorityLine{
      position:absolute;
      top:0; bottom:0;
      width:2px;
      background: var(--ink);
      z-index: 5;
      opacity: 0.8;
      pointer-events: none;
    }
    .seatMajorityLine::after {
        content: '';
        position: absolute;
        top: 0; left: -2px; right: -2px; height: 6px;
        background: var(--ink);
    }
    
    .seatTickLabel{
      position:absolute;
      bottom:8px;
      transform:translateX(-50%);
      font-size:11px;
      font-weight:600;
      color: var(--muted);
      font-family: var(--mono);
      user-select:none;
    }
    .seatTickLine{
      position:absolute;
      top:0; bottom:0;
      width:1px;
      background: var(--line-strong);
      opacity: 0.5;
    }
    .seatFooter{
      padding:16px 20px;
      border-top: 1px solid var(--line);
      background: var(--neutral-bg);
      color:var(--muted);
      font-size:12px;
      font-weight:500;
      line-height:1.5;
    }
    .mono{ font-family:var(--mono); font-weight: 500;}

    /* Map */
    .mapStage{
      position: relative;
      background: white; 
      border-radius: var(--radius-md);
      box-shadow: inset 0 0 20px rgba(0,0,0,0.03);
    }
    .mapSvg{
      width:100%;
      height:600px;
      overflow: visible;
      display:block;
    }

    .state{
      stroke: white;
      stroke-width: 1px;
      vector-effect: non-scaling-stroke;
      cursor:default;
      transition: fill 0.2s ease, filter 0.2s ease;
    }
    .state.active{ cursor:pointer; }
    .state.hovered{
      stroke: var(--ink);
      stroke-width:2px;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
      z-index: 10;
      position: relative; 
    }
    
    .district{
      stroke: rgba(255,255,255,0.4);
      stroke-width:0.5px;
      vector-effect: non-scaling-stroke;
      cursor:default;
      transition: opacity 0.2s ease;
    }
    .district.active{ cursor:pointer; }
    .district.hovered{
      stroke: var(--ink);
      stroke-width:1.5px;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.15));
    }

    .legendOverlay{
      position:absolute;
      left:20px;
      bottom:20px;
      padding:12px;
      border-radius:var(--radius-md);
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(8px);
      border:1px solid var(--line);
      box-shadow: var(--card-shadow);
    }
    .swatch{
      width:180px;
      height:14px;
      border-radius:99px;
      border:1px solid rgba(0,0,0,0.05);
      background: linear-gradient(90deg,
        var(--blue-dark) 0%,
        var(--blue) 35%,
        #fde047 50%,
        var(--red) 65%,
        var(--red-dark) 100%);
    }

    /* Tooltip */
    #tip{
      position:fixed;
      left:0; top:0;
      transform: translate(-9999px,-9999px);
      pointer-events:none;
      width: min(280px, calc(100vw - 28px));
      z-index:100;
      border-radius:var(--radius-lg);
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(16px);
      border:1px solid rgba(0,0,0,0.08);
      box-shadow: 0 20px 40px -5px rgba(0,0,0,0.15), 0 10px 20px -5px rgba(0,0,0,0.1);
      overflow:hidden;
      font-family: var(--sans);
    }
    .tipTop{
      padding:12px;
      border-bottom:1px solid var(--line);
      background: var(--neutral-bg);
    }
    .tipHeader{ display:flex; justify-content:space-between; gap:10px; align-items:flex-start; }
    .tipTitle{ margin:0; font-size:15px; font-weight:800; line-height:1.2; color: var(--ink); }
    .tipMeta{
      text-align:right;
      font-size:11px;
      color:var(--muted);
      font-weight:600;
      font-family: var(--mono);
    }
    .tipSub{
      margin-top:8px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:3px 8px;
      border-radius:6px;
      border:1px solid var(--line);
      background: white;
      font-variant-numeric: tabular-nums;
      font-size:12px;
      font-weight:600;
      color: var(--ink-dim);
      box-shadow: 0 1px 2px rgba(0,0,0,0.03);
    }
    .dot{ width:8px;height:8px;border-radius:50%; background: var(--muted-light); }
    .dot.blue{ background: var(--blue); }
    .dot.red{ background: var(--red); }

    .tipBody{
      display:block;
      padding:10px 12px 12px;
    }

    /* Compact tooltip sizing */
    #tip.compact{
      width: min(280px, calc(100vw - 28px));
    }
    #tip.compact .tipTop{ padding:10px 12px; }
    #tip.compact .tipTitle{ font-size:14px; }
    #tip.compact .badge{ font-size:11px; padding:2px 7px; }
    #tip.compact .tipMeta{ font-size:10px; }
    #tip.compact .tipBody{ padding:8px 12px 12px; }

    /* Ultra-compact “model factors” rows inside tooltip (no scroll) */
    .miniRow{
      display:flex;
      align-items:center;
      gap:10px;
      margin:7px 0;
    }
    .miniLbl{
      width:96px;
      font-size:10px;
      font-weight:800;
      text-transform:uppercase;
      letter-spacing:0.06em;
      color: var(--muted);
    }
    .miniVal{
      width:58px;
      text-align:right;
      font-family: var(--mono);
      font-size:11px;
      font-weight:800;
      color: var(--ink);
      font-variant-numeric: tabular-nums;
    }
    .miniBar{
      position:relative;
      flex:1;
      height:8px;
      border-radius:9999px;
      background: var(--neutral-bg);
      border:1px solid var(--line);
      overflow:hidden;
    }
    .miniZero{
      position:absolute;
      left:50%;
      top:0;
      bottom:0;
      width:1px;
      background: rgba(31,41,55,0.35);
    }
    .miniFill{
      position:absolute;
      top:0; bottom:0;
      border-radius:9999px;
      opacity:0.9;
    }
    .miniFill.blue{ background: var(--blue-soft); }
    .miniFill.red{ background: var(--red-soft); }
    .miniFill.neutral{ background: rgba(156,163,175,0.25); }

    .miniDot{
      position:absolute;
      top:50%;
      transform:translate(-50%,-50%);
      width:8px;
      height:8px;
      border-radius:9999px;
      border:2px solid #fff;
      box-shadow: 0 0 0 1px rgba(0,0,0,0.12);
    }
    .miniDot.blue{ background: var(--blue); }
    .miniDot.red{ background: var(--red); }
    .miniDot.neutral{ background: var(--muted-light); }
    .miniNote{
      font-size:11px;
      color: var(--muted);
      font-family: var(--mono);
    }


    .sliderBlock{ margin-top:16px; }
    .sliderLabelRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:8px;
    }
    .sliderLabel{
      font-size:12px;
      font-weight:700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      display:flex;
      align-items:center;
      gap:6px;
    }
    .chev{ width:12px;height:12px; opacity:.5; }
    .sliderValue{
      font-size:13px;
      font-weight:700;
      color:var(--ink);
      font-family: var(--mono);
    }
    .axis{
      position:relative;
      height:48px;
      border-radius:8px;
      overflow:hidden;
      border:1px solid var(--line);
      background: var(--neutral-bg);
    }

    .gridline{ position:absolute; top:0; bottom:0; width:1px; background: rgba(0,0,0,0.05); }
    .zeroLine{ background: var(--ink) !important; width:1px !important; opacity:0.3 !important; }
    .tickLabel{
      position:absolute;
      bottom:6px;
      transform:translateX(-50%);
      font-size:10px;
      font-weight:600;
      opacity:.7;
      user-select:none;
      font-family: var(--mono);
    }
    .tickBlue{ color: var(--blue-dark); }
    .tickRed{  color: var(--red-dark); }
    .tickZero{ color: var(--ink); opacity: 0.5;}

    .band{
      position:absolute;
      top:16px;
      height:10px;
      border-radius:5px;
      opacity: 0.8;
    }
    .marker{
      position:absolute;
      top:11px;
      width:20px; height:20px;
      border-radius:50%;
      transform:translateX(-50%);
      border:3px solid #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      z-index: 5;
    }
    .hr{ height:1px; background: var(--line); margin:16px 0; }


    /* Race Table */
    .tableScroll{ overflow:auto; border-radius:12px; border:1px solid var(--line); box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);}
    .bucketTable{
      width:100%;
      border-collapse:separate;
      border-spacing:8px;
      min-width:1000px;
      background: var(--neutral-bg);
      padding: 8px;
    }
    .bucketTable th{
      text-align:left;
      font-size:11px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
      font-weight: 700;
      padding:8px 12px;
      background: transparent;
      border-bottom: 2px solid var(--line);
      position:sticky;
      top:0;
      z-index:2;
    }
    .bucketTable td{ vertical-align:top; padding:0; }
    
    .raceItem{
      width:100%;
      display:flex;
      flex-direction:column;
      gap:4px;
      border-radius:8px;
      padding:10px 12px;
      border:1px solid var(--line);
      background: #fff;
      text-align:left;
      cursor:pointer;
      box-shadow: 0 1px 2px rgba(0,0,0,0.03);
      transition: all 0.15s ease;
      margin-bottom: 6px;
      position: relative;
      overflow: hidden;
    }
    .raceItem:hover{
      transform:translateY(-2px);
      box-shadow: 0 8px 16px -4px rgba(0,0,0,0.1);
      border-color: var(--line-strong);
    }
    
    .raceItem::before {
        content: "";
        position: absolute;
        left: 0; top: 0; bottom: 0; width: 4px;
    }
    .raceItem.d::before{ background: var(--blue); }
    .raceItem.r::before{ background: var(--red); }
    .raceItem.t::before{ background: var(--muted-light); }

    /* Race Item Internal Text */
    .raceTop { 
        font-size: 11px; 
        font-weight: 700; 
        color: var(--muted); 
        text-transform: uppercase; 
        letter-spacing: 0.05em; 
    }
    .raceName {
        font-size: 14px;
        font-weight: 700;
        color: var(--ink);
    }
    .raceBottom {
        font-family: var(--mono);
        font-size: 12px;
        color: var(--ink-dim);
        font-weight: 600;
        margin-top: 2px;
    }

    .raceEmpty{
      height:44px;
      border-radius:8px;
      border:1px dashed var(--line-strong);
      background:rgba(0,0,0,0.01);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--muted-light);
      font-size: 12px;
      font-weight: 500;
    }

    /* Error Handling */
    .loadError{
      margin: 10px 0 16px;
      padding: 16px;
      border-radius: var(--radius-md);
      border: 1px solid var(--red-border);
      background: var(--red-soft);
      color: var(--red-dark);
      box-shadow: var(--card-shadow);
      font-weight: 600;
      line-height: 1.4;
      font-size: 14px;
    }
    .loadError .mono{ font-family: var(--mono); background: rgba(255,255,255,0.5); padding: 2px 4px; border-radius: 4px; }

    /* Map Interaction */
    .state.focus, .district.focus{ 
        stroke: var(--ink); 
        stroke-width:2.5px; 
        z-index: 20; 
    }
    
    /* Utilities */
    .tiny{ font-size:12px; color:var(--muted); }
  
    
/* ---------- Panel header + simple seats (screenshot-style) ---------- */
.topCard{ padding:18px 20px; }
.panelHeaderRow{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:16px;
}
.panelTitleWrap{ display:flex; flex-direction:column; }
.panelTitle{
  font-size:22px;
  font-weight:900;
  letter-spacing:-0.02em;
  color: var(--ink);
  line-height:1.05;
}
.panelSub{
  font-size:14px;
  font-weight:600;
  color: var(--muted);
  margin-top:6px;
}
.pillRow{ display:flex; align-items:center; gap:10px; }
.metricPill{
  display:flex;
  align-items:center;
  gap:10px;
  padding:8px 14px;
  border-radius: var(--radius-pill);
  background: rgba(255,255,255,0.9);
  border:1px solid rgba(229,231,235,0.9);
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
  font-weight:800;
  font-size:14px;
  color: var(--ink);
  font-variant-numeric: tabular-nums;
  user-select:none;
  min-width: 84px;
  justify-content:center;
}
.metricPill .dot{
  width:10px; height:10px;
  border-radius:9999px;
  flex:0 0 auto;
}
.metricPill.blue .dot{ background: var(--blue); }
.metricPill.red  .dot{ background: var(--red); }

.seatsCard{ padding:0; }
.seatsSummary{
  min-height: 120px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:22px 18px 18px;
  background: rgba(255,255,255,0.65);
}
.seatsLine{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:24px;
  font-weight:900;
  font-size:20px;
  letter-spacing:0.01em;
  font-variant-numeric: tabular-nums;
}
.seatsSide{
  display:flex;
  align-items:baseline;
  gap:10px;
  font-family: var(--mono);
}
.seatsSide .lbl{ font-size:14px; font-weight:900; }
.seatsSide .num{ font-size:20px; font-weight:900; }
.seatsSide.d{ color: var(--blue); }
.seatsSide.r{ color: var(--red); }
.seatsDivider{ width:1px; height:34px; background: rgba(209,213,219,0.9); }

/* tiny seat simulation histogram */
.simMini{
  width: min(360px, 100%);
  margin-top: 14px;
  margin-left:auto;
  margin-right:auto;
}
.simCanvas{
  width: 100%;
  height: 26px;
  display:block;
}

.simTip{
  position:fixed;
  z-index:90;
  pointer-events:none;
  background: rgba(17,24,39,0.92);
  color:#fff;
  padding:6px 8px;
  border-radius:10px;
  font-size:11px;
  font-weight:700;
  font-family: var(--mono);
  line-height:1.25;
  box-shadow: 0 10px 24px rgba(0,0,0,0.18);
  transform: translate(-9999px,-9999px);
  white-space: nowrap;
}
.simTip .k{ font-weight:900; opacity:0.95; }

.mapCard{ position:relative; }
.mapHint{
  padding: 0 20px 16px;
  margin-top:-8px;
  font-size:12px;
  font-weight:600;
  color: var(--muted);
}

    /* ---------- Three-panel (Senate/Gov/House) layout ---------- */
    .triGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap:24px;
      margin-top: 0px;
    }
    @media (min-width: 980px){
      .triGrid{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }
    .modeCol{
      display:flex;
      flex-direction:column;
      gap:24px;
      min-width:0;
    }
    .modeHeader{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      padding: 0 4px;
    }
    .modeTitle{
      font-size:16px;
      font-weight:900;
      letter-spacing:-0.02em;
      color: var(--ink);
      line-height:1.1;
    }
    .modeSub{
      font-size:12px;
      font-weight:600;
      color: var(--muted);
      margin-top:4px;
    }
    .modeTitleWrap{ display:flex; flex-direction:column; }
    .mapGrid{ padding:20px; }
    .mapSvg{ height:520px; }
    @media (min-width: 980px){
      .mapSvg{ height:400px; }
      .triGrid .bucketTable{ min-width: 560px; }
    }

</style>
<style>
/* Presidential multi-year layout overrides */
#triGrid{
  grid-template-columns: repeat(7, minmax(320px, 1fr));
  overflow-x: auto;
  padding-bottom: 10px;
}
@media (max-width: 900px){
  #triGrid{ grid-template-columns: repeat(7, minmax(300px, 1fr)); }
}
</style></head>
<body>
<div class="wrap">
<div class="loadError" hidden="" id="loadError"></div>
<div aria-label="Three-panel forecast" class="triGrid" id="triGrid">
<!-- SENATE -->

<!-- GOVERNOR -->

<!-- HOUSE -->

<section class="modeCol" data-mode="2000">
<section class="card topCard">
<div class="panelHeaderRow">
<div class="panelTitleWrap">
<div class="panelTitle">2000 President</div>
<div class="panelSub">Loading…</div>
</div>
<div aria-label="National baseline" class="pillRow">
<div aria-label="Dem baseline" class="metricPill blue">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-d="">50.0</span>
</div>
<div aria-label="GOP baseline" class="metricPill red">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-r="">50.0</span>
</div>
</div>
</div>
</section>
<section aria-label="Projected seats" class="card seatsCard">
<div class="seatsSummary">
<div class="seatsLine">
<div class="seatsSide d"><span class="lbl">D</span><span class="num" data-seats-d="">—</span></div>
<div aria-hidden="true" class="seatsDivider"></div>
<div class="seatsSide r"><span class="lbl">R</span><span class="num" data-seats-r="">—</span></div>
</div>
<div aria-label="Seat simulation distribution" class="simMini">
<canvas class="simCanvas" data-sim-canvas=""></canvas>
</div>
</div>
</section>
<section aria-label="Map" class="card mapCard">
<div class="mapGrid">
<div class="mapStage">
<svg aria-label="2000 presidential map" class="mapSvg"></svg>
<div aria-hidden="true" class="legendOverlay">
<div class="swatch"></div>
</div>
</div>
</div>
<div class="mapHint" data-map-help="">Hover a state for details.</div>
</section>
</section><section class="modeCol" data-mode="2004">
<section class="card topCard">
<div class="panelHeaderRow">
<div class="panelTitleWrap">
<div class="panelTitle">2004 President</div>
<div class="panelSub">Loading…</div>
</div>
<div aria-label="National baseline" class="pillRow">
<div aria-label="Dem baseline" class="metricPill blue">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-d="">50.0</span>
</div>
<div aria-label="GOP baseline" class="metricPill red">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-r="">50.0</span>
</div>
</div>
</div>
</section>
<section aria-label="Projected seats" class="card seatsCard">
<div class="seatsSummary">
<div class="seatsLine">
<div class="seatsSide d"><span class="lbl">D</span><span class="num" data-seats-d="">—</span></div>
<div aria-hidden="true" class="seatsDivider"></div>
<div class="seatsSide r"><span class="lbl">R</span><span class="num" data-seats-r="">—</span></div>
</div>
<div aria-label="Seat simulation distribution" class="simMini">
<canvas class="simCanvas" data-sim-canvas=""></canvas>
</div>
</div>
</section>
<section aria-label="Map" class="card mapCard">
<div class="mapGrid">
<div class="mapStage">
<svg aria-label="2004 presidential map" class="mapSvg"></svg>
<div aria-hidden="true" class="legendOverlay">
<div class="swatch"></div>
</div>
</div>
</div>
<div class="mapHint" data-map-help="">Hover a state for details.</div>
</section>
</section><section class="modeCol" data-mode="2008">
<section class="card topCard">
<div class="panelHeaderRow">
<div class="panelTitleWrap">
<div class="panelTitle">2008 President</div>
<div class="panelSub">Loading…</div>
</div>
<div aria-label="National baseline" class="pillRow">
<div aria-label="Dem baseline" class="metricPill blue">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-d="">50.0</span>
</div>
<div aria-label="GOP baseline" class="metricPill red">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-r="">50.0</span>
</div>
</div>
</div>
</section>
<section aria-label="Projected seats" class="card seatsCard">
<div class="seatsSummary">
<div class="seatsLine">
<div class="seatsSide d"><span class="lbl">D</span><span class="num" data-seats-d="">—</span></div>
<div aria-hidden="true" class="seatsDivider"></div>
<div class="seatsSide r"><span class="lbl">R</span><span class="num" data-seats-r="">—</span></div>
</div>
<div aria-label="Seat simulation distribution" class="simMini">
<canvas class="simCanvas" data-sim-canvas=""></canvas>
</div>
</div>
</section>
<section aria-label="Map" class="card mapCard">
<div class="mapGrid">
<div class="mapStage">
<svg aria-label="2008 presidential map" class="mapSvg"></svg>
<div aria-hidden="true" class="legendOverlay">
<div class="swatch"></div>
</div>
</div>
</div>
<div class="mapHint" data-map-help="">Hover a state for details.</div>
</section>
</section><section class="modeCol" data-mode="2012">
<section class="card topCard">
<div class="panelHeaderRow">
<div class="panelTitleWrap">
<div class="panelTitle">2012 President</div>
<div class="panelSub">Loading…</div>
</div>
<div aria-label="National baseline" class="pillRow">
<div aria-label="Dem baseline" class="metricPill blue">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-d="">50.0</span>
</div>
<div aria-label="GOP baseline" class="metricPill red">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-r="">50.0</span>
</div>
</div>
</div>
</section>
<section aria-label="Projected seats" class="card seatsCard">
<div class="seatsSummary">
<div class="seatsLine">
<div class="seatsSide d"><span class="lbl">D</span><span class="num" data-seats-d="">—</span></div>
<div aria-hidden="true" class="seatsDivider"></div>
<div class="seatsSide r"><span class="lbl">R</span><span class="num" data-seats-r="">—</span></div>
</div>
<div aria-label="Seat simulation distribution" class="simMini">
<canvas class="simCanvas" data-sim-canvas=""></canvas>
</div>
</div>
</section>
<section aria-label="Map" class="card mapCard">
<div class="mapGrid">
<div class="mapStage">
<svg aria-label="2012 presidential map" class="mapSvg"></svg>
<div aria-hidden="true" class="legendOverlay">
<div class="swatch"></div>
</div>
</div>
</div>
<div class="mapHint" data-map-help="">Hover a state for details.</div>
</section>
</section><section class="modeCol" data-mode="2016">
<section class="card topCard">
<div class="panelHeaderRow">
<div class="panelTitleWrap">
<div class="panelTitle">2016 President</div>
<div class="panelSub">Loading…</div>
</div>
<div aria-label="National baseline" class="pillRow">
<div aria-label="Dem baseline" class="metricPill blue">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-d="">50.0</span>
</div>
<div aria-label="GOP baseline" class="metricPill red">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-r="">50.0</span>
</div>
</div>
</div>
</section>
<section aria-label="Projected seats" class="card seatsCard">
<div class="seatsSummary">
<div class="seatsLine">
<div class="seatsSide d"><span class="lbl">D</span><span class="num" data-seats-d="">—</span></div>
<div aria-hidden="true" class="seatsDivider"></div>
<div class="seatsSide r"><span class="lbl">R</span><span class="num" data-seats-r="">—</span></div>
</div>
<div aria-label="Seat simulation distribution" class="simMini">
<canvas class="simCanvas" data-sim-canvas=""></canvas>
</div>
</div>
</section>
<section aria-label="Map" class="card mapCard">
<div class="mapGrid">
<div class="mapStage">
<svg aria-label="2016 presidential map" class="mapSvg"></svg>
<div aria-hidden="true" class="legendOverlay">
<div class="swatch"></div>
</div>
</div>
</div>
<div class="mapHint" data-map-help="">Hover a state for details.</div>
</section>
</section><section class="modeCol" data-mode="2020">
<section class="card topCard">
<div class="panelHeaderRow">
<div class="panelTitleWrap">
<div class="panelTitle">2020 President</div>
<div class="panelSub">Loading…</div>
</div>
<div aria-label="National baseline" class="pillRow">
<div aria-label="Dem baseline" class="metricPill blue">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-d="">50.0</span>
</div>
<div aria-label="GOP baseline" class="metricPill red">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-r="">50.0</span>
</div>
</div>
</div>
</section>
<section aria-label="Projected seats" class="card seatsCard">
<div class="seatsSummary">
<div class="seatsLine">
<div class="seatsSide d"><span class="lbl">D</span><span class="num" data-seats-d="">—</span></div>
<div aria-hidden="true" class="seatsDivider"></div>
<div class="seatsSide r"><span class="lbl">R</span><span class="num" data-seats-r="">—</span></div>
</div>
<div aria-label="Seat simulation distribution" class="simMini">
<canvas class="simCanvas" data-sim-canvas=""></canvas>
</div>
</div>
</section>
<section aria-label="Map" class="card mapCard">
<div class="mapGrid">
<div class="mapStage">
<svg aria-label="2020 presidential map" class="mapSvg"></svg>
<div aria-hidden="true" class="legendOverlay">
<div class="swatch"></div>
</div>
</div>
</div>
<div class="mapHint" data-map-help="">Hover a state for details.</div>
</section>
</section><section class="modeCol" data-mode="2024">
<section class="card topCard">
<div class="panelHeaderRow">
<div class="panelTitleWrap">
<div class="panelTitle">2024 President</div>
<div class="panelSub">Loading…</div>
</div>
<div aria-label="National baseline" class="pillRow">
<div aria-label="Dem baseline" class="metricPill blue">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-d="">50.0</span>
</div>
<div aria-label="GOP baseline" class="metricPill red">
<span aria-hidden="true" class="dot"></span>
<span class="val" data-pill-r="">50.0</span>
</div>
</div>
</div>
</section>
<section aria-label="Projected seats" class="card seatsCard">
<div class="seatsSummary">
<div class="seatsLine">
<div class="seatsSide d"><span class="lbl">D</span><span class="num" data-seats-d="">—</span></div>
<div aria-hidden="true" class="seatsDivider"></div>
<div class="seatsSide r"><span class="lbl">R</span><span class="num" data-seats-r="">—</span></div>
</div>
<div aria-label="Seat simulation distribution" class="simMini">
<canvas class="simCanvas" data-sim-canvas=""></canvas>
</div>
</div>
</section>
<section aria-label="Map" class="card mapCard">
<div class="mapGrid">
<div class="mapStage">
<svg aria-label="2024 presidential map" class="mapSvg"></svg>
<div aria-hidden="true" class="legendOverlay">
<div class="swatch"></div>
</div>
</div>
</div>
<div class="mapHint" data-map-help="">Hover a state for details.</div>
</section>
</section></div>
</div>
<div aria-label="State details tooltip" id="tip" role="dialog">
<div class="tipTop">
<div class="tipHeader">
<div>
<p class="tipTitle" id="tipState">State</p>
<div class="tipSub">
<span class="badge" id="tipResultBadge"><span class="dot"></span><span id="tipWinner">—</span></span>
<span class="badge" id="tipProbBadge"><span class="dot"></span><span id="tipProb">—</span></span>
</div>
</div>
<div class="tipMeta" id="tipMeta">—</div>
</div>
</div>
<div class="tipBody" id="tipSliders"></div>
</div>
<div aria-hidden="true" class="simTip" id="simTip"></div>
<script>

(() => {
  'use strict';

  const YEARS = ["2000", "2004", "2008", "2012", "2016", "2020", "2024"];
  const PRES_DATA = {"2000":{"year":2000,"baseline":1996,"ratios":{"AK":{"ratioD":0.7229471529101722,"ratioR":1.33503416786297},"AL":{"ratioD":0.8452539894540718,"ratioR":1.1871310885917727},"AR":{"ratioD":1.084339953510147,"ratioR":0.8980094720603533},"AZ":{"ratioD":0.9358270942618407,"ratioR":1.0776029421793385},"CA":{"ratioD":1.0453063105580072,"ratioR":0.9452120336744932},"CO":{"ratioD":0.8995992799114084,"ratioR":1.1214124744107683},"CT":{"ratioD":1.102804498279984,"ratioR":0.8756806872927122},"DC":{"ratioD":1.6465023239862597,"ratioR":0.2181983675194451},"DE":{"ratioD":1.0710184941054635,"ratioR":0.914118832109346},"FL":{"ratioD":0.9711087599027087,"ratioR":1.0349375676380863},"GA":{"ratioD":0.9019183677292655,"ratioR":1.1186080503977391},"HI":{"ratioD":1.1742861375576215,"ratioR":0.789239447708196},"IA":{"ratioD":1.0182150637687641,"ratioR":0.9779729073480333},"ID":{"ratioD":0.7161778856012309,"ratioR":1.3432201001272137},"IL":{"ratioD":1.0889487237822573,"ratioR":0.8924361833206518},"IN":{"ratioD":0.8559500746697171,"ratioR":1.1741965382081299},"KS":{"ratioD":0.7294535581772832,"ratioR":1.3271661091249236},"KY":{"ratioD":0.9231349836674346,"ratioR":1.0929512439783917},"LA":{"ratioD":1.0333320592855633,"ratioR":0.9596922433275802},"MA":{"ratioD":1.2539712571177213,"ratioR":0.692877912342983},"MD":{"ratioD":1.0712882755268816,"ratioR":0.9137925911232702},"ME":{"ratioD":1.1447987672783542,"ratioR":0.824897903009247},"MI":{"ratioD":1.0472821111156814,"ratioR":0.9428227397088949},"MN":{"ratioD":1.0848490192445595,"ratioR":0.8973938695985565},"MO":{"ratioD":0.978271754716007,"ratioR":1.0262755090023845},"MS":{"ratioD":0.8632794363862244,"ratioR":1.165333295583301},"MT":{"ratioD":0.8826415798268913,"ratioR":1.1419190636639152},"NC":{"ratioD":0.8672482255892043,"ratioR":1.160533922460047},"ND":{"ratioD":0.8420121252935675,"ratioR":1.1910514065843438},"NE":{"ratioD":0.7206393635545223,"ratioR":1.3378249288838178},"NH":{"ratioD":1.0159906336589593,"ratioR":0.980662863790048},"NJ":{"ratioD":1.09555678103613,"ratioR":0.8844451989777827},"NM":{"ratioD":0.9869879547344178,"ratioR":1.0157351920528583},"NV":{"ratioD":0.9241851113738754,"ratioR":1.0916813466791115},"NY":{"ratioD":1.2060994337013875,"ratioR":0.7507682992884537},"OH":{"ratioD":0.9791836111663056,"ratioR":1.025172820218475},"OK":{"ratioD":0.8330730932182966,"ratioR":1.2018611896430533},"OR":{"ratioD":0.9992099060477232,"ratioR":1.0009554439617392},"PA":{"ratioD":1.007761618639434,"ratioR":0.9906140381900157},"RI":{"ratioD":1.2606649423528251,"ratioR":0.6847833798874022},"SC":{"ratioD":0.8566156364889035,"ratioR":1.1733916883298672},"SD":{"ratioD":0.8781441135582597,"ratioR":1.1473577548184382},"TN":{"ratioD":0.9369757126031565,"ratioR":1.076213942231433},"TX":{"ratioD":0.8648615724356281,"ratioR":1.1634200518093212},"UT":{"ratioD":0.6938808204361453,"ratioR":1.3701834710213914},"VA":{"ratioD":0.8940931252715016,"ratioR":1.1280709511500742},"VT":{"ratioD":1.1543118211712358,"ratioR":0.8133939674665673},"WA":{"ratioD":1.0449114654282703,"ratioR":0.9456895115667645},"WI":{"ratioD":1.0216096579458311,"ratioR":0.9738678961658982},"WV":{"ratioD":1.0661041840610912,"ratioR":0.9200616036550324},"WY":{"ratioD":0.776669850799937,"ratioR":1.270068441750019}},"ev":{"AL":9,"AK":3,"AZ":8,"AR":6,"CA":54,"CO":8,"CT":8,"DE":3,"DC":3,"FL":25,"GA":13,"HI":4,"ID":4,"IL":22,"IN":12,"IA":7,"KS":6,"KY":8,"LA":9,"ME":4,"MD":10,"MA":12,"MI":18,"MN":10,"MS":7,"MO":11,"MT":3,"NE":5,"NV":4,"NH":4,"NJ":15,"NM":5,"NY":33,"NC":14,"ND":3,"OH":21,"OK":8,"OR":7,"PA":23,"RI":4,"SC":8,"SD":3,"TN":11,"TX":32,"UT":5,"VT":3,"VA":13,"WA":11,"WV":5,"WI":11,"WY":3},"natPollMargin":-2.0,"statePollMargin":{"PA":2.0,"MI":4.0,"WI":1.0,"FL":-2.0,"OH":-3.0,"NV":-4.0,"IA":0.0,"NH":-2.0,"MN":5.0}},"2004":{"year":2004,"baseline":2000,"ratios":{"AK":{"ratioD":0.6395767897544603,"ratioR":1.3623264737841625},"AL":{"ratioD":0.8456342980243485,"ratioR":1.1551808509556076},"AR":{"ratioD":0.9415068787682468,"ratioR":1.0588020020744293},"AZ":{"ratioD":0.9318939998503227,"ratioR":1.068465643100413},"CA":{"ratioD":1.1211075149742264,"ratioR":0.8782529604031875},"CO":{"ratioD":0.9078907935248848,"ratioR":1.0925956016052627},"CT":{"ratioD":1.1820005224706187,"ratioR":0.8170383991399164},"DC":{"ratioD":1.805000664438043,"ratioR":0.19074842061075817},"DE":{"ratioD":1.1318207987148357,"ratioR":0.867483103717932},"FL":{"ratioD":0.9972816056165519,"ratioR":1.0027327492328766},"GA":{"ratioD":0.8780127995883471,"ratioR":1.1226313703322415},"HI":{"ratioD":1.1934032595363102,"ratioR":0.8055754483779902},"IA":{"ratioD":1.0006205847775738,"ratioR":0.9993761381405232},"ID":{"ratioD":0.5814988922021415,"ratioR":1.4207110595343246},"IL":{"ratioD":1.1206491284086049,"ratioR":0.8787137675411033},"IN":{"ratioD":0.8376983839556731,"ratioR":1.1631586716925086},"KS":{"ratioD":0.7796088562511604,"ratioR":1.2215549490094573},"KY":{"ratioD":0.8432271699835624,"ratioR":1.1576006901617757},"LA":{"ratioD":0.9187955568442243,"ratioR":1.081633254207448},"MA":{"ratioD":1.2923835579120377,"ratioR":0.7060724711414529},"MD":{"ratioD":1.165576590545947,"ratioR":0.8335490598598058},"ME":{"ratioD":1.0521860411921484,"ratioR":0.947538383354877},"MI":{"ratioD":1.0499272881275137,"ratioR":0.9498090640707515},"MN":{"ratioD":1.0230342172737754,"ratioR":0.9768441474246357},"MO":{"ratioD":0.9632245054092708,"ratioR":1.0369696925668297},"MS":{"ratioD":0.8257158920940322,"ratioR":1.1752044387240437},"MT":{"ratioD":0.7249636666641637,"ratioR":1.2764886999153304},"NC":{"ratioD":0.8684331591038773,"ratioR":1.132261597404725},"ND":{"ratioD":0.7035992351659733,"ratioR":1.2979659491853457},"NE":{"ratioD":0.6945812968574282,"ratioR":1.3070315079375479},"NH":{"ratioD":0.9840526265998246,"ratioR":1.0160315856636106},"NJ":{"ratioD":1.1611704031298886,"ratioR":0.8379785147448143},"NM":{"ratioD":0.9980103951946231,"ratioR":1.0020001111828096},"NV":{"ratioD":0.9603343194646137,"ratioR":1.0398751405295035},"NY":{"ratioD":1.2681802504960782,"ratioR":0.7304035873977129},"OH":{"ratioD":0.9606956934153186,"ratioR":1.0395118582947462},"OK":{"ratioD":0.7763421834204154,"ratioR":1.224838871948172},"OR":{"ratioD":1.0020790001980673,"ratioR":0.997910021360031},"PA":{"ratioD":1.0402302686182188,"ratioR":0.9595572900038859},"RI":{"ratioD":1.3095338411002042,"ratioR":0.6888316235619235},"SC":{"ratioD":0.8345601772970892,"ratioR":1.1663134500760541},"SD":{"ratioD":0.7656894090557829,"ratioR":1.2355478997295017},"TN":{"ratioD":0.9582193233107931,"ratioR":1.0420013052067416},"TX":{"ratioD":0.7788236702316467,"ratioR":1.2223442813100083},"UT":{"ratioD":0.5640046613812535,"ratioR":1.438297671008598},"VA":{"ratioD":0.9146466755721839,"ratioR":1.0858040442085233},"VT":{"ratioD":1.1058947935724996,"ratioR":0.8935460146390494},"WA":{"ratioD":1.0561142860587,"ratioR":0.9435893948596886},"WI":{"ratioD":0.9996688732938368,"ratioR":1.0003328752655474},"WV":{"ratioD":0.9327023741300412,"ratioR":1.0676530000909112},"WY":{"ratioD":0.5788296176840959,"ratioR":1.4233944295177021}},"ev":{"AL":9,"AK":3,"AZ":10,"AR":6,"CA":55,"CO":9,"CT":7,"DE":3,"DC":3,"FL":27,"GA":15,"HI":4,"ID":4,"IL":21,"IN":11,"IA":7,"KS":6,"KY":8,"LA":9,"ME":4,"MD":10,"MA":12,"MI":17,"MN":10,"MS":6,"MO":11,"MT":3,"NE":5,"NV":5,"NH":4,"NJ":15,"NM":5,"NY":31,"NC":15,"ND":3,"OH":20,"OK":7,"OR":7,"PA":21,"RI":4,"SC":8,"SD":3,"TN":11,"TX":34,"UT":5,"VT":3,"VA":13,"WA":11,"WV":5,"WI":10,"WY":3},"natPollMargin":0.0,"statePollMargin":{"PA":1.0,"MI":2.0,"WI":1.0,"FL":-3.0,"OH":-2.0,"NV":-3.0,"IA":-1.0,"CO":-4.0,"NH":0.0,"MN":2.0}},"2008":{"year":2008,"baseline":2004,"ratios":{"AK":{"ratioD":0.7541445145884447,"ratioR":1.2339764028566849},"AL":{"ratioD":0.7608815339339577,"ratioR":1.2275648983510996},"AR":{"ratioD":0.9241643493015946,"ratioR":1.072171473941313},"AZ":{"ratioD":0.9172069716001799,"ratioR":1.0787926896736664},"CA":{"ratioD":1.1287711240621177,"ratioR":0.8774507538465923},"CO":{"ratioD":0.9768592788566032,"ratioR":1.0220226231014458},"CT":{"ratioD":1.1335622797042786,"ratioR":0.872891094090363},"DC":{"ratioD":1.8563631075468328,"ratioR":0.18501407805659306},"DE":{"ratioD":1.1039606120334835,"ratioR":0.9010624879829077},"FL":{"ratioD":0.9736303404573863,"ratioR":1.0250955477930785},"GA":{"ratioD":0.8540590811587739,"ratioR":1.1388894421570817},"HI":{"ratioD":1.115710332183675,"ratioR":0.8898804830310453},"IA":{"ratioD":1.018480696176874,"ratioR":0.9824122418643052},"ID":{"ratioD":0.6291202140325124,"ratioR":1.3529598620411802},"IL":{"ratioD":1.132202341829046,"ratioR":0.8741853233878009},"IN":{"ratioD":0.8116236462465419,"ratioR":1.1792745098231634},"KS":{"ratioD":0.7615105579542117,"ratioR":1.226966267096958},"KY":{"ratioD":0.8201519049787823,"ratioR":1.1711583138494985},"LA":{"ratioD":0.8750444391585953,"ratioR":1.1189180407899795},"MA":{"ratioD":1.2867119277229333,"ratioR":0.7271412293591039},"MD":{"ratioD":1.160030274416452,"ratioR":0.8477019624213364},"ME":{"ratioD":1.119372360279298,"ratioR":0.8863953943841938},"MI":{"ratioD":1.0607783229548842,"ratioR":0.9421583238102637},"MN":{"ratioD":1.0614974490403521,"ratioR":0.9414739439828356},"MO":{"ratioD":0.9511532179506583,"ratioR":1.0464866355773905},"MS":{"ratioD":0.8218582589117662,"ratioR":1.1695344063960136},"MT":{"ratioD":0.8100527576147234,"ratioR":1.1807694972982083},"NC":{"ratioD":0.8973766988849669,"ratioR":1.0976648164021208},"ND":{"ratioD":0.7401362930457698,"ratioR":1.2473077844261788},"NE":{"ratioD":0.6798850041981621,"ratioR":1.3046478913936672},"NH":{"ratioD":1.0395414498427338,"ratioR":0.9623690877490341},"NJ":{"ratioD":1.0945071770953199,"ratioR":0.9100591581111686},"NM":{"ratioD":1.0171752449625644,"ratioR":0.9836546171512254},"NV":{"ratioD":0.9983643514293032,"ratioR":1.001556618386076},"NY":{"ratioD":1.2269716550416587,"ratioR":0.7839950111010228},"OH":{"ratioD":1.0036728059617823,"ratioR":0.9965046542447898},"OK":{"ratioD":0.7060720217857285,"ratioR":1.2797261607825854},"OR":{"ratioD":1.0686282887993852,"ratioR":0.9346876474177088},"PA":{"ratioD":1.051189692111162,"ratioR":0.951283657537836},"RI":{"ratioD":1.2423056740476952,"ratioR":0.7694018910721466},"SC":{"ratioD":0.8482938342282063,"ratioR":1.1443761277038236},"SD":{"ratioD":0.8015786742644576,"ratioR":1.1888341355001337},"TN":{"ratioD":0.8780282242991314,"ratioR":1.1160784242041983},"TX":{"ratioD":0.7893376030917256,"ratioR":1.2004837507011696},"UT":{"ratioD":0.5466033442143615,"ratioR":1.4314897363806725},"VA":{"ratioD":0.9406125850781227,"ratioR":1.0565179731301009},"VT":{"ratioD":1.236635120793225,"ratioR":0.7747984582891326},"WA":{"ratioD":1.1001673314668232,"ratioR":0.9046724873308076},"WI":{"ratioD":1.0293186597723851,"ratioR":0.9720979398176192},"WV":{"ratioD":0.8925012254035011,"ratioR":1.1023047199841254},"WY":{"ratioD":0.608818304755375,"ratioR":1.3722808371084467}},"ev":{"AL":9,"AK":3,"AZ":10,"AR":6,"CA":55,"CO":9,"CT":7,"DE":3,"DC":3,"FL":27,"GA":15,"HI":4,"ID":4,"IL":21,"IN":11,"IA":7,"KS":6,"KY":8,"LA":9,"ME":4,"MD":10,"MA":12,"MI":17,"MN":10,"MS":6,"MO":11,"MT":3,"NE":5,"NV":5,"NH":4,"NJ":15,"NM":5,"NY":31,"NC":15,"ND":3,"OH":20,"OK":7,"OR":7,"PA":21,"RI":4,"SC":8,"SD":3,"TN":11,"TX":34,"UT":5,"VT":3,"VA":13,"WA":11,"WV":5,"WI":10,"WY":3},"natPollMargin":7.0,"statePollMargin":{"PA":10.5,"MI":16.0,"WI":11.0,"FL":2.0,"OH":6.0,"NC":0.0,"NV":7.0,"IA":9.5,"VA":7.0,"CO":7.5,"NH":9.0}},"2012":{"year":2012,"baseline":2008,"ratios":{"AK":{"ratioD":0.7240963269444148,"ratioR":1.3209127930930056},"AL":{"ratioD":0.7273300945066957,"ratioR":1.3171514898485357},"AR":{"ratioD":0.7407050597388154,"ratioR":1.3015946202982829},"AZ":{"ratioD":0.8496456642266078,"ratioR":1.1748821583718536},"CA":{"ratioD":1.1582213299826614,"ratioR":0.8159674774558131},"CO":{"ratioD":1.0145035574916155,"ratioR":0.9831304270332004},"CT":{"ratioD":1.1403656922370253,"ratioR":0.8367359671172557},"DC":{"ratioD":1.7370175852153427,"ratioR":0.14275018809746903},"DE":{"ratioD":1.164910634906276,"ratioR":0.8081869230938002},"FL":{"ratioD":0.9562753636097444,"ratioR":1.050857587489044},"GA":{"ratioD":0.8809929053785113,"ratioR":1.138421133397421},"HI":{"ratioD":1.3574983131686251,"ratioR":0.5841817510640096},"IA":{"ratioD":1.0200482634979344,"ratioR":0.9766811939669595},"ID":{"ratioD":0.6876489227578627,"ratioR":1.36330598833017},"IL":{"ratioD":1.16669832363634,"ratioR":0.8061076025208187},"IN":{"ratioD":0.9395802961789546,"ratioR":1.0702761789878656},"KS":{"ratioD":0.7883042464595038,"ratioR":1.2462304136883398},"KY":{"ratioD":0.7767523977462977,"ratioR":1.2596667554190857},"LA":{"ratioD":0.7539938128159273,"ratioR":1.2861380269899363},"MA":{"ratioD":1.1753054942648677,"ratioR":0.7960963143910212},"MD":{"ratioD":1.1703401397798894,"ratioR":0.8018716843193159},"ME":{"ratioD":1.0940800728882756,"ratioR":0.8905723195686217},"MI":{"ratioD":1.0855582787900238,"ratioR":0.9004843033995965},"MN":{"ratioD":1.027126406979755,"ratioR":0.968448368468451},"MO":{"ratioD":0.9286164839647745,"ratioR":1.0830285557925443},"MS":{"ratioD":0.8063502010767841,"ratioR":1.2252405601060197},"MT":{"ratioD":0.9081253474229495,"ratioR":1.1068624822802227},"NC":{"ratioD":0.9329597816628342,"ratioR":1.0779767209253879},"ND":{"ratioD":0.8478834509061082,"ratioR":1.1769318476436355},"NE":{"ratioD":0.7883637843256311,"ratioR":1.2461611632042773},"NH":{"ratioD":1.0204158113616233,"ratioR":0.9762536867495836},"NJ":{"ratioD":1.0761354691413243,"ratioR":0.9114442885627466},"NM":{"ratioD":1.0724210000583079,"ratioR":0.915764711828907},"NV":{"ratioD":1.048650428086004,"ratioR":0.9434130593864744},"NY":{"ratioD":1.22304108176603,"ratioR":0.7405734554697218},"OH":{"ratioD":0.9732768084025734,"ratioR":1.0310826382299088},"OK":{"ratioD":0.6389144253664365,"ratioR":1.4199907127655547},"OR":{"ratioD":1.0863471758658807,"ratioR":0.8995667108163867},"PA":{"ratioD":1.0271325222001315,"ratioR":0.9684412556510332},"RI":{"ratioD":1.1939226601796935,"ratioR":0.7744420658374},"SC":{"ratioD":0.8453584189210226,"ratioR":1.1798687968259673},"SD":{"ratioD":0.8499840169491324,"ratioR":1.174488608999953},"TN":{"ratioD":0.7879472498158522,"ratioR":1.246645648428676},"TX":{"ratioD":0.8194799047736915,"ratioR":1.2099689624531345},"UT":{"ratioD":0.659719777541485,"ratioR":1.3957913115621017},"VA":{"ratioD":0.9890612892056123,"ratioR":1.0127231805034953},"VT":{"ratioD":1.2813501689938556,"ratioR":0.6727522052567343},"WA":{"ratioD":1.0926388031199432,"ratioR":0.892248708657008},"WI":{"ratioD":1.0610910190702578,"ratioR":0.9289429917854527},"WV":{"ratioD":0.805758564098487,"ratioR":1.2259287128699887},"WY":{"ratioD":0.6218616236526012,"ratioR":1.4398253969777708}},"ev":{"AL":9,"AK":3,"AZ":11,"AR":6,"CA":55,"CO":9,"CT":7,"DE":3,"DC":3,"FL":29,"GA":16,"HI":4,"ID":4,"IL":20,"IN":11,"IA":6,"KS":6,"KY":8,"LA":8,"ME":4,"MD":10,"MA":11,"MI":16,"MN":10,"MS":6,"MO":10,"MT":3,"NE":5,"NV":6,"NH":4,"NJ":14,"NM":5,"NY":29,"NC":15,"ND":3,"OH":18,"OK":7,"OR":7,"PA":20,"RI":4,"SC":9,"SD":3,"TN":11,"TX":38,"UT":6,"VT":3,"VA":13,"WA":12,"WV":5,"WI":10,"WY":3},"natPollMargin":1.0,"statePollMargin":{"PA":3.7,"MI":2.6,"WI":1.5,"FL":-0.6,"OH":2.8,"NC":-2.8,"NV":3.7,"IA":2.5,"VA":2.0,"CO":0.2,"NH":2.0}},"2016":{"year":2016,"baseline":2012,"ratios":{"AK":{"ratioD":0.8207036488486118,"ratioR":1.1943147218298658},"AL":{"ratioD":0.74569987983561,"ratioR":1.2756010191714504},"AR":{"ratioD":0.7276614500017516,"ratioR":1.29515039902723},"AZ":{"ratioD":0.8726535773476436,"ratioR":1.1380133200414522},"CA":{"ratioD":1.1896354094737889,"ratioR":0.7944801910113686},"CO":{"ratioD":1.014191789697932,"ratioR":0.9846194657631756},"CT":{"ratioD":1.1300268721917415,"ratioR":0.8590817083666563},"DC":{"ratioD":1.7801930104658907,"ratioR":0.15445581112646561},"DE":{"ratioD":1.1429932021468754,"ratioR":0.8450292818548714},"FL":{"ratioD":0.9698587820782925,"ratioR":1.0326659317853306},"GA":{"ratioD":0.8852806196119859,"ratioR":1.1243286009193216},"HI":{"ratioD":1.3786578558276916,"ratioR":0.589624688671298},"IA":{"ratioD":1.0182553391694824,"ratioR":0.9802155418677054},"ID":{"ratioD":0.6456197231200259,"ratioR":1.3840641735412682},"IL":{"ratioD":1.1262765456482053,"ratioR":0.8631461728936732},"IN":{"ratioD":0.8613673713567419,"ratioR":1.1502448906426015},"KS":{"ratioD":0.7476783839413884,"ratioR":1.273456789952703},"KY":{"ratioD":0.7394213847788099,"ratioR":1.2824054187737726},"LA":{"ratioD":0.7931793639232525,"ratioR":1.224144518892056},"MA":{"ratioD":1.1879601433258773,"ratioR":0.7962957822012169},"MD":{"ratioD":1.217493851803181,"ratioR":0.7642882465736454},"ME":{"ratioD":1.112479132352743,"ratioR":0.878099296642498},"MI":{"ratioD":1.053655914191756,"ratioR":0.941849714320762},"MN":{"ratioD":1.0371339498365482,"ratioR":0.9597556052502123},"MO":{"ratioD":0.8694755948911235,"ratioR":1.1414574993181263},"MS":{"ratioD":0.8498017910620568,"ratioR":1.1627792367312462},"MT":{"ratioD":0.8261075940943862,"ratioR":1.188458126810094},"NC":{"ratioD":0.9414740472144278,"ratioR":1.0634282525122558},"ND":{"ratioD":0.7669462267585586,"ratioR":1.2525750179967376},"NE":{"ratioD":0.747369528801797,"ratioR":1.2737915156743924},"NH":{"ratioD":1.0158404149895237,"ratioR":0.9828327469432995},"NJ":{"ratioD":1.1334759866003663,"ratioR":0.8553436863569088},"NM":{"ratioD":1.0631670387248218,"ratioR":0.9315419110327217},"NV":{"ratioD":1.0268727425814959,"ratioR":0.9708763203155208},"NY":{"ratioD":1.269810226456322,"ratioR":0.7075897040623779},"OH":{"ratioD":0.9904664886908451,"ratioR":1.0103320652439614},"OK":{"ratioD":0.638872297301232,"ratioR":1.3913767828756298},"OR":{"ratioD":1.0819319786776995,"ratioR":0.911205166510694},"PA":{"ratioD":1.013882749453904,"ratioR":0.984954392094174},"RI":{"ratioD":1.2308570821967688,"ratioR":0.7498056741174667},"SC":{"ratioD":0.8592931485578209,"ratioR":1.1524928562235917},"SD":{"ratioD":0.7841104447096511,"ratioR":1.2339730764894195},"TN":{"ratioD":0.7623343496633364,"ratioR":1.25757319899215},"TX":{"ratioD":0.8073868222882067,"ratioR":1.208747003536239},"UT":{"ratioD":0.48786508316173116,"ratioR":1.5550327893776497},"VA":{"ratioD":0.9991825211117986,"ratioR":1.000885953237434},"VT":{"ratioD":1.3121976223953913,"ratioR":0.6616518196709762},"WA":{"ratioD":1.108025688852443,"ratioR":0.8829257731959176},"WI":{"ratioD":1.027947303892292,"ratioR":0.9697117507029459},"WV":{"ratioD":0.6984383123772282,"ratioR":1.3268213495069223},"WY":{"ratioD":0.5544976916616987,"ratioR":1.482818844685952}},"ev":{"AL":9,"AK":3,"AZ":11,"AR":6,"CA":55,"CO":9,"CT":7,"DE":3,"DC":3,"FL":29,"GA":16,"HI":4,"ID":4,"IL":20,"IN":11,"IA":6,"KS":6,"KY":8,"LA":8,"ME":4,"MD":10,"MA":11,"MI":16,"MN":10,"MS":6,"MO":10,"MT":3,"NE":5,"NV":6,"NH":4,"NJ":14,"NM":5,"NY":29,"NC":15,"ND":3,"OH":18,"OK":7,"OR":7,"PA":20,"RI":4,"SC":9,"SD":3,"TN":11,"TX":38,"UT":6,"VT":3,"VA":13,"WA":12,"WV":5,"WI":10,"WY":3},"natPollMargin":3.2,"statePollMargin":{"PA":2.1,"MI":3.6,"WI":6.5,"FL":-0.2,"OH":-2.2,"NC":-0.8,"AZ":-3.0,"NV":0.8,"GA":-4.8,"IA":-3.0,"VA":5.3,"CO":3.9,"NH":1.0,"MN":3.7}},"2020":{"year":2020,"baseline":2016,"ratios":{"AK":{"ratioD":0.8133743293216876,"ratioR":1.1955111135654146},"AL":{"ratioD":0.6963261553097152,"ratioR":1.318132073258172},"AR":{"ratioD":0.6980658226557659,"ratioR":1.3163095785347851},"AZ":{"ratioD":0.9403348695784793,"ratioR":1.0625058495293744},"CA":{"ratioD":1.292510761177304,"ratioR":0.69356249630728},"CO":{"ratioD":1.029723540065726,"ratioR":0.9688612911812479},"CT":{"ratioD":1.11686168713122,"ratioR":0.877574406022949},"DC":{"ratioD":1.870412933243239,"ratioR":0.0881457989053568},"DE":{"ratioD":1.0945225941547503,"ratioR":0.90097708652235},"FL":{"ratioD":0.9651809081600004,"ratioR":1.0364768651291758},"GA":{"ratioD":0.9252623517342167,"ratioR":1.078295985673324},"HI":{"ratioD":1.3181765142890896,"ratioR":0.6666747699128245},"IA":{"ratioD":0.8783066603547527,"ratioR":1.1274872865081225},"ID":{"ratioD":0.6193943124566719,"ratioR":1.398726721412253},"IL":{"ratioD":1.153578036207129,"ratioR":0.8391099532614585},"IN":{"ratioD":0.7795282225832729,"ratioR":1.230968668757206},"KS":{"ratioD":0.7600968249956264,"ratioR":1.2513252154567303},"KY":{"ratioD":0.6709856638389752,"ratioR":1.344679051965507},"LA":{"ratioD":0.7784655769490599,"ratioR":1.2320819080587195},"MA":{"ratioD":1.263643344112709,"ratioR":0.7238043212156262},"MD":{"ratioD":1.251231367248921,"ratioR":0.7368072452472841},"ME":{"ratioD":1.0084864987890552,"ratioR":0.9911094501496545},"MI":{"ratioD":0.97497648652956,"ratioR":1.0262149090537385},"MN":{"ratioD":0.9935322661043968,"ratioR":1.0067756694541439},"MO":{"ratioD":0.7853674201647058,"ratioR":1.2248514608869003},"MS":{"ratioD":0.7996105132546838,"ratioR":1.2099302392751246},"MT":{"ratioD":0.7601321247182696,"ratioR":1.2512882350774637},"NC":{"ratioD":0.9400666579798485,"ratioR":1.0627868309620407},"ND":{"ratioD":0.5900942725461652,"ratioR":1.429421766791559},"NE":{"ratioD":0.7124799372560491,"ratioR":1.3012091929001717},"NH":{"ratioD":0.9811273987319528,"ratioR":1.019771145504158},"NJ":{"ratioD":1.1196497124901477,"ratioR":0.8746536398679429},"NM":{"ratioD":1.0681786140806024,"ratioR":0.9285753309724383},"NV":{"ratioD":1.0025626069142657,"ratioR":0.9973153846969846},"NY":{"ratioD":1.239411342709518,"ratioR":0.7491900334868112},"OH":{"ratioD":0.8938622277278331,"ratioR":1.1111911023433243},"OK":{"ratioD":0.5999551017511303,"ratioR":1.4190914532203664},"OR":{"ratioD":1.0975954931478535,"ratioR":0.8977578836022372},"PA":{"ratioD":0.9699363284532104,"ratioR":1.0314950343144877},"RI":{"ratioD":1.1399503730834217,"ratioR":0.8533864436441931},"SC":{"ratioD":0.8314617282102952,"ratioR":1.1765625547451812},"SD":{"ratioD":0.6650979829320338,"ratioR":1.350847051503031},"TN":{"ratioD":0.710981402537288,"ratioR":1.3027790744203107},"TX":{"ratioD":0.8851538938534385,"ratioR":1.1203140490788623},"UT":{"ratioD":0.7352460940305745,"ratioR":1.2773591156497353},"VA":{"ratioD":1.0325193890856144,"ratioR":0.9659323288726201},"VT":{"ratioD":1.2741030869015464,"ratioR":0.7128465791599881},"WA":{"ratioD":1.1490215791151788,"ratioR":0.843883348029297},"WI":{"ratioD":0.9693020129439514,"ratioR":1.0321595502469223},"WV":{"ratioD":0.5441269181794922,"ratioR":1.4775776748572584},"WY":{"ratioD":0.47485234275636923,"ratioR":1.550150485090272}},"ev":{"AL":9,"AK":3,"AZ":11,"AR":6,"CA":55,"CO":9,"CT":7,"DE":3,"DC":3,"FL":29,"GA":16,"HI":4,"ID":4,"IL":20,"IN":11,"IA":6,"KS":6,"KY":8,"LA":8,"ME":4,"MD":10,"MA":11,"MI":16,"MN":10,"MS":6,"MO":10,"MT":3,"NE":5,"NV":6,"NH":4,"NJ":14,"NM":5,"NY":29,"NC":15,"ND":3,"OH":18,"OK":7,"OR":7,"PA":20,"RI":4,"SC":9,"SD":3,"TN":11,"TX":38,"UT":6,"VT":3,"VA":13,"WA":12,"WV":5,"WI":10,"WY":3},"natPollMargin":4.5,"statePollMargin":{"PA":4.2,"MI":6.5,"WI":6.0,"FL":0.5,"OH":-1.0,"NC":0.3,"AZ":0.9,"NV":2.4,"GA":-1.0,"IA":-2.9,"VA":11.0,"CO":11.0,"NH":9.0,"MN":6.7}},"2024":{"year":2024,"baseline":2020,"ratios":{"AK":{"ratioD":0.8562523377164836,"ratioR":1.157286953930771},"AL":{"ratioD":0.7098465425092292,"ratioR":1.3174824047656049},"AR":{"ratioD":0.6849453272613667,"ratioR":1.3447290133941743},"AZ":{"ratioD":0.9599615351249678,"ratioR":1.0438096041369858},"CA":{"ratioD":1.24230450981625,"ratioR":0.734873335209314},"CO":{"ratioD":1.0897537734626934,"ratioR":0.9017925063442346},"CT":{"ratioD":1.1520849661953192,"ratioR":0.8335904689403143},"DC":{"ratioD":1.8080217389782796,"ratioR":0.11587238348910664},"DE":{"ratioD":1.1412080657187924,"ratioR":0.8454918419225531},"FL":{"ratioD":0.9245236574305835,"ratioR":1.0825853014093867},"GA":{"ratioD":0.959243776609203,"ratioR":1.0445949668260837},"HI":{"ratioD":1.2446730484635622,"ratioR":0.7322817088608572},"IA":{"ratioD":0.8768956018804914,"ratioR":1.1346993438926956},"ID":{"ratioD":0.6530841196279635,"ratioR":1.3795911615335286},"IL":{"ratioD":1.1226870554931645,"ratioR":0.8657573073627083},"IN":{"ratioD":0.8001132557042983,"ratioR":1.2187136586569383},"KS":{"ratioD":0.8135416950908182,"ratioR":1.2040204226515838},"KY":{"ratioD":0.704320518853747,"ratioR":1.3235289130309418},"LA":{"ratioD":0.7758181022211624,"ratioR":1.2452971218308029},"MA":{"ratioD":1.2845377949605543,"ratioR":0.6886621852725888},"MD":{"ratioD":1.282882206614041,"ratioR":0.6904737100226245},"ME":{"ratioD":1.0463477008313826,"ratioR":0.9492869061683602},"MI":{"ratioD":0.984014294807122,"ratioR":1.0174913653292255},"MN":{"ratioD":1.026617275087193,"ratioR":0.9708756994451518},"MO":{"ratioD":0.8069885793509416,"ratioR":1.2111907626564742},"MS":{"ratioD":0.7964779981509503,"ratioR":1.2226913135157156},"MT":{"ratioD":0.7962446097045489,"ratioR":1.2229466843317274},"NC":{"ratioD":0.9438648507378858,"ratioR":1.0614224015585927},"ND":{"ratioD":0.6274325128240893,"ratioR":1.4076588395292484},"NE":{"ratioD":0.7697009888669243,"ratioR":1.2519903932972962},"NH":{"ratioD":1.0287103799104764,"ratioR":0.9685854494565102},"NJ":{"ratioD":1.1114377976520673,"ratioR":0.8780661092708621},"NM":{"ratioD":1.0625793785144937,"ratioR":0.931526400714524},"NV":{"ratioD":0.9803693875683098,"ratioR":1.0214795787571573},"NY":{"ratioD":1.1897299973192919,"ratioR":0.7923997310732838},"OH":{"ratioD":0.8789351788833849,"ratioR":1.1324676633978878},"OK":{"ratioD":0.6327411316318485,"ratioR":1.4018502130195163},"OR":{"ratioD":1.1159522253437677,"ratioR":0.873126477077277},"PA":{"ratioD":0.9682368187088776,"ratioR":1.0347548889009264},"RI":{"ratioD":1.1598231505919108,"ratioR":0.8251234411406274},"SC":{"ratioD":0.8435293639274973,"ratioR":1.1712082780095152},"SD":{"ratioD":0.699828990011116,"ratioR":1.3284434895807593},"TN":{"ratioD":0.7305858629029351,"ratioR":1.2947896911624674},"TX":{"ratioD":0.9027821681791027,"ratioR":1.1063745760588717},"UT":{"ratioD":0.7522928762495249,"ratioR":1.2710381396312451},"VA":{"ratioD":1.055616477930612,"ratioR":0.9391451223407682},"VT":{"ratioD":1.3071916581664933,"ratioR":0.6638746020742003},"WA":{"ratioD":1.1469260737684306,"ratioR":0.8392352666545299},"WI":{"ratioD":0.9630665176064582,"ratioR":1.0404121698499587},"WV":{"ratioD":0.5780318714792035,"ratioR":1.4617124239558146},"WY":{"ratioD":0.526702416767251,"ratioR":1.5178764926461774}},"ev":{"AL":9,"AK":3,"AZ":11,"AR":6,"CA":54,"CO":10,"CT":7,"DE":3,"DC":3,"FL":30,"GA":16,"HI":4,"ID":4,"IL":19,"IN":11,"IA":6,"KS":6,"KY":8,"LA":8,"ME":4,"MD":10,"MA":11,"MI":15,"MN":10,"MS":6,"MO":10,"MT":4,"NE":5,"NV":6,"NH":4,"NJ":14,"NM":5,"NY":28,"NC":16,"ND":3,"OH":17,"OK":7,"OR":8,"PA":19,"RI":4,"SC":9,"SD":3,"TN":11,"TX":40,"UT":6,"VT":3,"VA":13,"WA":12,"WV":4,"WI":10,"WY":3},"natPollMargin":0.1,"statePollMargin":{"PA":0.0,"MI":1.1,"WI":1.4,"FL":-5.0,"OH":-8.0,"NC":-0.7,"AZ":-1.0,"NV":0.6,"GA":0.1,"IA":-4.0,"VA":7.0,"CO":9.0,"NH":5.0,"MN":5.0}}};
  const FIPS_TO_USPS = {"01":"AL","02":"AK","04":"AZ","05":"AR","06":"CA","08":"CO","09":"CT","10":"DE","11":"DC","12":"FL","13":"GA","15":"HI","16":"ID","17":"IL","18":"IN","19":"IA","20":"KS","21":"KY","22":"LA","23":"ME","24":"MD","25":"MA","26":"MI","27":"MN","28":"MS","29":"MO","30":"MT","31":"NE","32":"NV","33":"NH","34":"NJ","35":"NM","36":"NY","37":"NC","38":"ND","39":"OH","40":"OK","41":"OR","42":"PA","44":"RI","45":"SC","46":"SD","47":"TN","48":"TX","49":"UT","50":"VT","51":"VA","53":"WA","54":"WV","55":"WI","56":"WY"};
  const USPS_TO_NAME = {"AL":"Alabama","AK":"Alaska","AZ":"Arizona","AR":"Arkansas","CA":"California","CO":"Colorado","CT":"Connecticut","DE":"Delaware","DC":"District of Columbia","FL":"Florida","GA":"Georgia","HI":"Hawaii","ID":"Idaho","IL":"Illinois","IN":"Indiana","IA":"Iowa","KS":"Kansas","KY":"Kentucky","LA":"Louisiana","ME":"Maine","MD":"Maryland","MA":"Massachusetts","MI":"Michigan","MN":"Minnesota","MS":"Mississippi","MO":"Missouri","MT":"Montana","NE":"Nebraska","NV":"Nevada","NH":"New Hampshire","NJ":"New Jersey","NM":"New Mexico","NY":"New York","NC":"North Carolina","ND":"North Dakota","OH":"Ohio","OK":"Oklahoma","OR":"Oregon","PA":"Pennsylvania","RI":"Rhode Island","SC":"South Carolina","SD":"South Dakota","TN":"Tennessee","TX":"Texas","UT":"Utah","VT":"Vermont","VA":"Virginia","WA":"Washington","WV":"West Virginia","WI":"Wisconsin","WY":"Wyoming"};

  const SIGMA_NAT = 2.0;      // common national shock (pp)
  const SIGMA_BG  = 3.5;      // battleground idiosyncratic shock (pp)
  const SIGMA_OTH = 3.0;

  const POLL_BLEND_W = 0.65;  // battleground state polls weight vs ratio model

  const topoUrl = "https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json";

  const tip = document.getElementById('tip');
  const tipTitle = document.getElementById('tipTitle');
  const tipBody = document.getElementById('tipBody');
  const tipMeta = document.getElementById('tipMeta');

  function fmtPct(x) {
    const s = (x>=0?"+":"") + x.toFixed(1);
    return s;
  }

  function clamp(x,a,b) { return Math.max(a, Math.min(b, x)); }

  // Approx erf for normal CDF
  function erf(x) {
    // Abramowitz & Stegun 7.1.26
    const sign = x < 0 ? -1 : 1;
    const ax = Math.abs(x);
    const t = 1 / (1 + 0.3275911 * ax);
    const a1=0.254829592, a2=-0.284496736, a3=1.421413741, a4=-1.453152027, a5=1.061405429;
    const y = 1 - ((((a5*t + a4)*t + a3)*t + a2)*t + a1)*t*Math.exp(-ax*ax);
    return sign*y;
  }
  function normCdf(z) { return 0.5*(1+erf(z/Math.SQRT2)); }

  function dShareFromMargin(m) {
    return 0.5 + m/200.0;
  }

  function ratioModelMargin(modeKey, usps) {
    const d = PRES_DATA[modeKey];
    const mNat = d.natPollMargin || 0;
    const ratios = d.ratios[usps];
    if (!ratios) return mNat;

    const dNat = 0.5 + mNat/200.0;
    const rNat = 1 - dNat;

    const d0 = ratios.ratioD * dNat;
    const r0 = ratios.ratioR * rNat;
    const dShare = d0 / (d0 + r0);
    const m = (2*dShare - 1)*100.0;
    return m;
  }

  function meanStateMargin(modeKey, usps) {
    const d = PRES_DATA[modeKey];
    const mRatio = ratioModelMargin(modeKey, usps);

    const mPoll = (d.statePollMargin && d.statePollMargin[usps] !== undefined) ? d.statePollMargin[usps] : null;
    if (mPoll === null) return mRatio;

    return (1-POLL_BLEND_W)*mRatio + POLL_BLEND_W*mPoll;
  }

  function sigmaState(modeKey, usps) {
    const d = PRES_DATA[modeKey];
    const hasPoll = (d.statePollMargin && d.statePollMargin[usps] !== undefined);
    return hasPoll ? SIGMA_BG : SIGMA_OTH;
  }

  function colorForMargin(m) {
    if (Math.abs(m) < 2.0) return "#facc15"; // tossup yellow
    const t = clamp(Math.abs(m)/20.0, 0, 1);
    if (m >= 0) return d3.interpolateRgb("#dbeafe", "#1d4ed8")(t);
    return d3.interpolateRgb("#fee2e2", "#b91c1c")(t);
  }

  function showTip(htmlTitle, htmlBody, metaText, x, y) {
    tipTitle.textContent = htmlTitle;
    tipBody.innerHTML = htmlBody;
    tipMeta.textContent = metaText || "";
    tip.style.left = (x + 14) + "px";
    tip.style.top  = (y + 14) + "px";
    tip.style.opacity = 1;
  }
  function hideTip() {
    tip.style.opacity = 0;
  }

  function randomNormal() {
    // Box-Muller
    let u=0, v=0;
    while(u===0) u=Math.random();
    while(v===0) v=Math.random();
    return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);
  }

  function simulate(modeKey, states) {
    const d = PRES_DATA[modeKey];
    const evMap = d.ev;
    const n = 4000;
    const demEVs = new Array(n);
    let demWins = 0;

    for (let i=0; i<n; i++) {
      const natShock = randomNormal()*SIGMA_NAT;
      let evD = 0;
      for (const st of states) {
        const usps = st.usps;
        const ev = evMap[usps] || 0;
        const mu = st.mu;
        const sig = st.sig;
        const eps = randomNormal()*sig;
        const m = mu + natShock + eps;
        if (m >= 0) evD += ev; // ties -> Dem
      }
      demEVs[i] = evD;
      if (evD >= 270) demWins++;
    }
    demEVs.sort((a,b)=>a-b);
    const median = demEVs[Math.floor(n/2)];
    const pDem = demWins/n;
    return { demEVs, median, pDem };
  }

  function drawHist(svg, values) {
    // simple histogram 0..538 in 19 bins (width 28-ish)
    const W = 320, H = 80, pad = 4;
    const bins = 19;
    const min = 0, max = 538;
    const bw = (max-min)/bins;
    const counts = new Array(bins).fill(0);
    for (const v of values) {
      const idx = Math.min(bins-1, Math.max(0, Math.floor((v-min)/bw)));
      counts[idx]++;
    }
    const maxC = Math.max(...counts);
    const x0 = pad, y0 = H - pad;
    const barW = (W - 2*pad) / bins;

    svg.attr("viewBox", `0 0 ${W} ${H}`);
    svg.selectAll("*").remove();

    svg.append("rect")
      .attr("x",0).attr("y",0).attr("width",W).attr("height",H)
      .attr("fill","transparent");

    svg.selectAll("rect.bar")
      .data(counts)
      .enter()
      .append("rect")
      .attr("class","bar")
      .attr("x",(d,i)=>x0 + i*barW)
      .attr("y",(d)=>y0 - (d/maxC)*(H-2*pad))
      .attr("width",barW-1)
      .attr("height",(d)=> (d/maxC)*(H-2*pad));
  }

  function updateColumn(modeKey, usFeatures) {
    const col = document.querySelector(`section.modeCol[data-mode="${modeKey}"]`);
    if (!col) return;

    const d = PRES_DATA[modeKey];
    const year = d.year;
    const baseline = d.baseline;
    const mNat = d.natPollMargin || 0;

    col.querySelector(".panelTitle").textContent = `${year} President`;
    col.querySelector(".panelSub").textContent = `Baseline: ${baseline} • National polling: ${fmtPct(mNat)}`;
    col.querySelector(".seatLabel").textContent = "EV";

    const svg = d3.select(col.querySelector("svg.mapSvg"));
    const histSvg = d3.select(col.querySelector("svg.histSvg"));
    const seatTotalEl = col.querySelector(".seatTotal");
    const demPill = col.querySelector(".demPill");
    const repPill = col.querySelector(".repPill");

    const projection = d3.geoAlbersUsa()
      .scale(1300)
      .translate([487.5, 305]);
    const path = d3.geoPath(projection);

    svg.attr("viewBox","0 0 975 610");
    svg.selectAll("*").remove();

    // Precompute per-state means/sigmas for simulation and tooltip
    const states = [];
    for (const f of usFeatures) {
      const id = String(f.id).padStart(2,"0");
      const usps = FIPS_TO_USPS[id];
      if (!usps) continue;
      const mu = meanStateMargin(modeKey, usps);
      const sig = sigmaState(modeKey, usps);
      states.push({ usps, mu, sig });
      f._usps = usps;
      f._mu = mu;
      f._sig = sig;
    }

    const sim = simulate(modeKey, states);
    const pDem = sim.pDem;
    const pRep = 1 - pDem;
    const medianEV = sim.median;

    seatTotalEl.textContent = String(medianEV);
    demPill.textContent = `D win ${Math.round(pDem*100)}%`;
    repPill.textContent = `R win ${Math.round(pRep*100)}%`;

    // Map
    svg.append("g")
      .selectAll("path.state")
      .data(usFeatures)
      .enter()
      .append("path")
      .attr("class","state")
      .attr("d", path)
      .attr("fill", (f) => colorForMargin(f._mu))
      .attr("stroke", "white")
      .attr("stroke-width", 0.7)
      .on("mousemove", function(event, f) {
        const usps = f._usps;
        if (!usps) return;
        const name = USPS_TO_NAME[usps] || usps;
        const mu = f._mu;
        const ev = d.ev[usps] || 0;
        const mRatio = ratioModelMargin(modeKey, usps);
        const mPoll = (d.statePollMargin && d.statePollMargin[usps] !== undefined) ? d.statePollMargin[usps] : null;

        const pState = normCdf(mu / Math.sqrt(SIGMA_NAT*SIGMA_NAT + f._sig*f._sig));
        const body = `
          <div style="margin-bottom:6px;"><b>Mean margin:</b> ${fmtPct(mu)} pp</div>
          <div><b>EV:</b> ${ev}</div>
          <div style="margin-top:6px;"><b>Ratio model:</b> ${fmtPct(mRatio)} pp</div>
          <div><b>State poll:</b> ${mPoll===null ? "—" : fmtPct(mPoll)+" pp"}</div>
          <div style="margin-top:6px;"><b>Dem win (approx):</b> ${Math.round(pState*100)}%</div>
        `;
        showTip(name, body, `${year}`, event.pageX, event.pageY);
      })
      .on("mouseleave", hideTip);

    // Histogram
    drawHist(histSvg, sim.demEVs);
    col.querySelector(".histHint").textContent = "EV distribution (simulated)";
  }

  async function main() {
    // Fetch topojson
    let us;
    try {
      us = await fetch(topoUrl).then(r => r.json());
    } catch (e) {
      console.error("Failed to load topojson:", e);
      return;
    }
    const features = topojson.feature(us, us.objects.states).features;

    // Update all columns
    YEARS.forEach(y => updateColumn(y, features));
  }

  // start
  main();
})();

</script>
</body>
</html>
